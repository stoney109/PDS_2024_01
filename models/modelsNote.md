# 🧠 모델링 작업 문서

**Decision Tree**와 **KoBERT**를 사용하여 각각 **입양 여부 예측 및 텍스트 감성 분석**을 목표로 모델을 학습하였습니다.
이 문서는 모델링 작업 과정을 설명하며, 사용된 라이브러리 도구, 데이터셋, 성능 지표를 체계적으로 정리합니다.

---

## 📜 목차
1. [🌳 Decision Tree](#-decision-tree)
2. [📚 KoBERT](#-kobert)


---

## 🛠 사용된 도구 및 라이브러리

### **데이터 처리**
- **📊 pandas**: 데이터 프레임 생성 및 데이터 처리 

### **모델 생성**
- **🧩 sklearn**: Decision Tree 모델 생성 및 성능 지표 계산 
- **📚 transformers**: 자연어 처리 모델 활용 (koBERT).
- **🔥 torch**: PyTorch를 사용한 딥러닝 계산.

---

## 🌳 Decision Tree

### **설명**
Decision Tree는 데이터 기반 의사 결정을 위한 머신러닝 알고리즘으로, 트리 구조를 사용합니다. 데이터를 반복적으로 나누면서 각 노드에서 **최적의 분할 기준**을 찾아 최종적으로 데이터가 하나의 클래스로 나뉠 때까지 트리를 확장합니다.

- **장점**: 
  - 트리 구조가 직관적이고 시각적으로 이해하기 쉬움.
  - 비선형 데이터 처리 가능.

### **모델 적용**
- **목표**: 유기견의 견종, 나이, 체중, 성별, 중성화 여부를 기준으로 **입양 여부**를 분류합니다.

#### **사용 데이터**
1. `sample_data_decision_tree.csv` (버전 1) : **나이와 체중의 소수점 제거**
2. `sample_data_decision_tree_version2.csv` (버전 2) : **성별,중성화 여부 미상 데이터 제거**




#### **독립변수 및 종속변수**
- **독립변수**: 견종, 나이, 체중, 성별, 중성화 여부
- **종속변수**: 입양 여부

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

### **Decision Tree 성능 평가 결과**

| **지표**                  | **Version 1** | **Version 2** | **성능 평가 결과 비교**             |
|---------------------------|---------------|---------------|-----------------------------|
| **Accuracy**              | 0.66          | 0.65          | 1번 모델의 정확도가 더 높음.           |
| **Precision**             | 0.81          | 0.72          | 1번 모델이 FP를 더 줄여 Precision 향상. |
| **Specificity**           | 0.90          | 0.82          | 1번 모델이 음성 예측에서 더 정확함.       |
| **Recall / Sensitivity**  | 0.42          | 0.47          | 2번 모델이 양성 예측에서 더 민감함.       |
| **Error Rate**            | 0.34          | 0.35          | 1번 모델이 오류율이 더 낮음.           |
| **F1 Score**              | 0.55          | 0.57          | 2번 모델의 F1 Score이 더 높음.        |



#### **성능 평가 지표**

- **Accuracy**: 모델의 전체적인 성능을 확인하는 기본 지표.
- **Precision**: 양성으로 예측한 것 중 실제로 양성인 비율.
- **Specificity**: 실제 음성 중에서 음성으로 정확히 예측한 비율.
- **Sensitivity / Recall**: 실제 양성 중에서 양성으로 정확히 예측한 비율.
- **Error Rate (Misclassification Rate)**: 전체 데이터 중 잘못 예측한 비율.
- **F1 Score**: Precision과 Recall의 조화 평균.

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

## 피처 중요도 결과 비교

### version1 결과
- version 1 에서는 견종이 가장 영향이 큼

| 순서 | Feature             | Importance |
|------|---------------------|------------|
| 0    | final_견종          | 0.881214   |
| 1    | final_체중          | 0.047698   |
| 2    | final_나이          | 0.032339   |
| 3    | final_중성화 여부   | 0.027339   |
| 4    | final_성별          | 0.011410   |

![decision_tree1](https://github.com/user-attachments/assets/f8b2a12b-492b-4022-91c6-0d05a2906f01)


### version2 결과
- version 2 에서도 역시 견종이이 가장 영향이 큼

| 순서 | Feature             | Importance |
|------|---------------------|------------|
| 0    | final_견종          | 0.825758   |
| 1    | final_체중          | 0.103520   |
| 2    | final_나이          | 0.039166   |
| 3    | final_중성화 여부   | 0.031557   |
| 4    | final_성별          | 0.000000   |

![decision_tree2](https://github.com/user-attachments/assets/9033aa00-fba3-40a4-8f9e-6aea4ec76b39)


---

## 📚 KoBERT

### 설명
사전 학습된 KoBERT 모델을 사용하여 텍스트 데이터에 대해 **감성 분석**을 수행하여 데이터의 긍정(Positive), 부정(Negative), 중립(Neutral) 발생 개수를 추출합니다.


### **주요 작업**

1. **텍스트 데이터의 감정 분류**: 
    - KoBERT 모델을 사용하여 각 텍스트의 긍정(Positive), 부정(Negative), 중립(Neutral)을 분류.
    - 감정 확률의 차이가 작으면 (<0.2) 중립으로 간주.
   

2. **입력 데이터 (CSV 파일)를 로드하고, 텍스트 데이터를 전처리** :
   - CSV 파일에서 특정 열 데이터를 로드.
   - 결측값을 처리하고 데이터를 분석 가능한 형태로 가공.
   

3. **병렬 처리를 통해 감성 분석 작업을 최적화**
   - `multiprocessing`을 활용하여 CPU 코어를 최대한 사용.
   - 큰 데이터셋을 효율적으로 처리.


4. **분석 결과를 데이터프레임에 추가하고, 결과를 CSV 파일로 저장**
   - 긍정, 부정, 중립 감정 개수를 데이터프레임의 새로운 열에 추가.
   - 감성 분석이 완료된 데이터를 새로운 CSV 파일로 저장.


### 출력 파일:
- **gpt_sentiment_koBert.csv**: 분석 결과가 추가된 텍스트 데이터.
---

## ✨ 문서 목적

이 문서는 다음 두 가지 주요 작업에 대한 과정을 체계적으로 정리하고, 그 결과를 비교 분석하여 최적의 솔루션을 도출하는 것을 목적으로 합니다:

1. **Decision Tree 모델을 활용하여 유기견의 입양 여부를 예측:**

   - 유기견의 견종, 체중, 성별, 중성화 여부를 기반으로 입양 여부를 분류하기 위한 모델을 개발하고, 성능 평가를 통해 최적의 버전을 선택합니다.


2. **KoBERT를 활용한 텍스트 데이터의 감성 분석:**
   - KoBERT 모델을 통해 텍스트 데이터의 긍정(Positive), 부정(Negative), 중립(Neutral) 감정을 분류하고, 분석 결과를 바탕으로 데이터의 감정 경향을 파악합니다.
   
문서 작성의 주요 목적은 모델링 과정의 재현성을 확보하고, 결과를 체계적으로 기록하여 향후 개선 작업에 참고할 수 있도록 하는 데 있습니다.
